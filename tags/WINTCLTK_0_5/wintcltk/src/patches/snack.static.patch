--- win/configure.orig	Thu Apr 26 13:44:33 2007
+++ win/configure	Thu Apr 26 13:39:11 2007
@@ -2835,12 +2835,6 @@
 file=$TCL_BIN_DIR/tclConfig.sh
 . $file
 
-if test "$TCL_SHARED_BUILD" = 0; then
-    { { echo "$as_me:$LINENO: error: Tcl and Tk must be configured with the --enable-shared flag" >&5
-echo "$as_me: error: Tcl and Tk must be configured with the --enable-shared flag" >&2;}
-   { (exit 1); exit 1; }; }
-fi
-
 #--------------------------------------------------------------------
 #       Read in configuration information generated by Tk and arrange
 #	for it to be substituted into our Makefile.
--- win/Makefile.in.orig	Thu Apr 26 13:41:14 2007
+++ win/Makefile.in	Thu Apr 26 13:44:00 2007
@@ -19,13 +19,13 @@
 WORKAROUND = $(srcdir)/../generic $(srcdir)
 VPATH = $(WORKAROUND)
 
-DEFINES = -DWIN -DUSE_TCL_STUBS -DUSE_TK_STUBS -DBUILD_snack -DTCL_81_API
+DEFINES = -DWIN -DUSE_TCL_STUBS -DUSE_TK_STUBS -DBUILD_snack -DTCL_81_API -DSTATIC_BUILD=1
 
 TCL_LIB_SPEC = @TCL_LIB_SPEC@
 TK_LIB_SPEC = @TK_LIB_SPEC@
 
-SNACK_DLL = libsnack.dll
-SOUND_DLL = libsound.dll
+SNACK_DLL = libsnack.a
+SOUND_DLL = libsound.a
 SNACK_STUB = @SNACK_STUB_LIB_FILE@
 SNACK_STUB_OBJS = snackStubInit.o
 
@@ -121,10 +121,10 @@
 	cp $(SNACK_PKG_FILE) "$(SNACK_INSTALL_DIR)/$(SNACK_PKG_FILE_DEST)"
 
 $(SNACK_DLL): $(SNACK_OBJS)
-	gcc -shared -o $@ $(SNACK_OBJS) $(SNACK_LIBS)
+	ar rcs $@ $(SNACK_OBJS) 
 
 $(SOUND_DLL): $(SOUND_OBJS)
-	gcc -shared -o $@ $(SOUND_OBJS) $(SOUND_LIBS)
+	ar rcs $@ $(SOUND_OBJS) 
 
 $(SNACK_STUB) : $(SNACK_STUB_OBJS)
 	ar cr $@ $(SNACK_STUB_OBJS)
--- generic/snack.c.orig	Thu Apr 26 14:03:10 2007
+++ generic/snack.c	Thu Apr 26 14:03:22 2007
@@ -42,12 +42,6 @@
 
 HINSTANCE snackHInst = NULL;
 
-BOOL APIENTRY
-DllMain(HINSTANCE hInst, DWORD reason, LPVOID reserved)
-{
-  snackHInst = hInst;
-  return TRUE;
-}
 #endif
 
 #ifdef MAC
--- generic/sound.c.orig	Thu Apr 26 14:03:13 2007
+++ generic/sound.c	Thu Apr 26 14:03:29 2007
@@ -41,12 +41,6 @@
 
 HINSTANCE snackHInst = NULL;
 
-BOOL APIENTRY
-DllMain(HINSTANCE hInst, DWORD reason, LPVOID reserved)
-{
-  snackHInst = hInst;
-  return TRUE;
-}
 #endif
 
 #ifdef MAC
